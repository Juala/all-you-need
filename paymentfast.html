<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Payment | ROJA STORE</title>
<style>
body { font-family:Poppins, Arial, sans-serif; background:#f4f7fc; margin:0; padding:0; }
.container { max-width:500px; margin:50px auto; background:#fff; padding:25px; border-radius:15px; box-shadow:0 5px 20px rgba(0,0,0,0.1);}
h2 { text-align:center; font-weight:700; color:#2d2d2d; margin-bottom:15px;}
.info-box { margin-top:20px; padding:15px; border-radius:10px; background:#eef3ff; border:1px solid #cdd8ff; }
p { font-size:15px; margin:6px 0; }
.value { font-weight:bold; color:#004aad; }
.qris-box { margin-top:20px; text-align:center; }
.qris-box img { border-radius:10px; border:1px solid #ddd; width:250px; }
button { background:#007bff; width:100%; padding:14px; color:white; border:none; border-radius:10px; font-size:17px; font-weight:600; cursor:pointer; margin-top:18px; }
button:hover { background:#005fcc; }
#btnOrderAgain { background:#28a745; margin-top:10px; }

/* kolom kode admin */
#kodeAdminBox { 
  margin-top:25px; 
  padding:15px; 
  background:#fff7e6; 
  border:1px solid #ffd57a; 
  border-radius:10px; 
}
#kodeAdmin { 
  width:100%; 
  padding:12px; 
  border:1px solid #ccc; 
  border-radius:10px; 
  font-size:16px;
}
#lanjutPremium { 
  display:none; 
  background:#ff6600; 
}
</style>
</head>
<body>

<div class="container">
  <h2>Konfirmasi Pembayaran (FAST)</h2>

  <div class="info-box">
    <p><strong>Order ID:</strong> <span id="orderId" class="value"></span></p>
    <p><strong>Produk:</strong> <span id="produk" class="value"></span></p>
    <p><strong>Jumlah:</strong> <span id="jumlah" class="value"></span></p>
    <p><strong>Nomor WhatsApp:</strong> <span id="phone" class="value"></span></p>
    <p><strong>Total Pembayaran:</strong> <span id="harga" class="value"></span></p>
  </div>

  <div class="qris-box">
    <p>Silakan Scan QRIS untuk membayar, lalu tekan tombol Konfirmasi Pembayaran</p>
    <img src="qris.png" alt="QRIS">
  </div>

  <button onclick="kirimWA()">Konfirmasi Pembayaran</button>
  <button id="btnOrderAgain" onclick="pesanLagi()">Pesan Lagi</button>

  <!-- kode admin -->
  <div id="kodeAdminBox">
    <p><strong>Masukkan Kode dari Admin:</strong></p>
    <input type="text" id="kodeAdmin" placeholder="Tempel kode admin di sini">
    <button onclick="cekKode()">Verifikasi Kode</button>
  </div>

  <button id="lanjutPremium" onclick="lanjutPremiumku()">Lanjutkan Pembayaran Premiumku</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyDpj7udfBLEqlloEqidlSJYHt-2icTOGCw",
  authDomain: "database-jualan.firebaseapp.com",
  databaseURL: "https://database-jualan-default-rtdb.firebaseio.com",
  projectId: "database-jualan",
  storageBucket: "database-jualan.appspot.com",
  messagingSenderId: "766732892106",
  appId: "1:766732892106:web:cd223204bfbb529599c133"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

const params = new URLSearchParams(window.location.search);
const orderId = params.get("orderId") || `ROJA-${Date.now()}`;
const product = params.get("product");
const jumlah = params.get("jumlah");
const phone = params.get("phone");
const username = params.get("username") || "-";
const hargaTotal = params.get("harga");

// tampil ke UI
document.getElementById("orderId").textContent = orderId;
document.getElementById("produk").textContent = product;
document.getElementById("jumlah").textContent = jumlah;
document.getElementById("phone").textContent = phone;
document.getElementById("harga").textContent = "Rp " + Number(hargaTotal).toLocaleString("id-ID");

// simpan firebase
set(ref(db, "orders_fast/" + orderId), {
  id: orderId,
  nama: username,
  whatsapp: phone,
  produk: product,
  total: hargaTotal,
  status: "Pending"
});

// WA konfirmasi
window.kirimWA = function(){
  let waMsg = `Halo Mas, saya ingin konfirmasi pembayaran FAST.\nOrder ID: ${orderId}\nProduk: ${product}\nJumlah: ${jumlah}\nUsername/Link: ${username}\nNomor: ${phone}\nTotal: Rp ${Number(hargaTotal).toLocaleString("id-ID")}`;
  window.open(`https://wa.me/6282132745904?text=${encodeURIComponent(waMsg)}`, "_blank");
}

// tombol pesan lagi
window.pesanLagi = function(){
  window.location.href = "index.html";
}

// verifikasi kode admin
window.cekKode = function(){
  const kode = document.getElementById("kodeAdmin").value.trim();

  if(kode.length < 5){
    alert("Kode tidak valid. Cek kembali ya bang.");
    return;
  }

  alert("Kode valid! Silakan lanjutkan ke Premiumku.");
  document.getElementById("lanjutPremium").style.display = "block";
}

// lanjut ke Premiumku
window.lanjutPremiumku = function(){
  window.location.href = "https://premiumku.store";
}
</script>

</body>
</html>
